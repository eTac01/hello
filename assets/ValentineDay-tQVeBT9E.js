import{l as a,h as r,I as u,r as p,G as d,f as l,j as y}from"./three-BDTjZVi7.js";import{g as o}from"./gsap-C8pce-KX.js";import{B as g}from"./BaseExperience-h4Cay5xU.js";import{C as c}from"./index-BhknYvxf.js";class x extends g{constructor(t,i,s){super(t,i,s),this.entity1=null,this.entity2=null,this.mergeProgress=0}getInstruction(){return"Witness the union..."}getCompletionMessage(){return"Two souls,<br>one light,<br>eternal."}async init(){this.createEntities(),await super.init(),this.startAutonomousMotion(),this.unsubscribeUpdate=this.sceneManager.onUpdate(this.update.bind(this))}createEntities(){const t=(i,s)=>{const e=new d,n=new r(new u(.4,2),new p({color:i,transparent:!0,opacity:.9}));e.add(n);const h=new r(new u(.7,2),new p({color:i,transparent:!0,opacity:.3,side:y,blending:l}));return e.add(h),e.position.copy(s),e.userData={core:n,glow:h,velocity:new a},e};this.entity1=t(c.champagneGold,new a(-3,1,0)),this.entity2=t(c.roseRed,new a(3,-1,0)),this.group.add(this.entity1,this.entity2)}startAutonomousMotion(){const t=o.timeline();t.to(this.entity1.position,{x:-1,y:.5,duration:8,ease:"sine.inOut"},0),t.to(this.entity2.position,{x:1,y:-.5,duration:8,ease:"sine.inOut"},0),t.to(this.entity1.position,{x:.3,y:0,duration:6,ease:"power2.in"},8),t.to(this.entity2.position,{x:-.3,y:0,duration:6,ease:"power2.in",onComplete:()=>this.onMerge()},8)}onMerge(){if(this.isCompleted)return;const t=new r(new u(.5,3),new p({color:16777215,transparent:!0}));t.position.set(0,0,0),this.group.add(t),o.to([this.entity1,this.entity2],{visible:!1,duration:.5}),o.to(t.scale,{x:15,y:15,z:15,duration:3,ease:"power2.out"}),o.to(t.material,{opacity:0,duration:3,delay:.5,onComplete:()=>this.complete()})}update(t,i){var e,n;if(!this.isActive)return;this.entity1&&(this.entity1.rotation.y+=t*.5),this.entity2&&(this.entity2.rotation.y-=t*.5);const s=Math.sin(i*2)*.1+1;(e=this.entity1)!=null&&e.userData.glow&&this.entity1.userData.glow.scale.setScalar(s),(n=this.entity2)!=null&&n.userData.glow&&this.entity2.userData.glow.scale.setScalar(s)}dispose(){this.unsubscribeUpdate&&this.unsubscribeUpdate(),super.dispose()}}export{x as default};
