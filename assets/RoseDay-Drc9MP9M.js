import{R as e,V as t,B as n,M as i,C as o,a as s,E as r,L as a,b as d,P as l,D as c,c as h,G as f,S as u,d as p,g as b}from"./index-DI5LSjs4.js";import{B as m}from"./BaseExperience-CpvtY6rA.js";class x extends m{constructor(n,i,o){super(n,i,o),this.gamePhase="intro",this.currentQuestionIndex=0,this.correctAnswers=0,this.quizQuestions=[{question:"What does a red rose symbolize?",options:["Friendship","Love and Romance","Gratitude","Peace"],correct:1},{question:"Rose Day is celebrated on which date in Valentine's Week?",options:["February 7th","February 10th","February 12th","February 14th"],correct:0},{question:"A dozen roses typically represents what?",options:["Friendship","Be mine","Gratitude","Perfect love"],correct:3}],this.box=null,this.boxLid=null,this.letter=null,this.revealedRose=null,this.raycaster=new e,this.mouse=new t,this.romanticQuote="Life is the flower for which love is the honey.",this.quoteAuthor="‚Äî Victor Hugo"}getInstruction(){return'Click "Let\'s Go" to reveal your surprise...'}getCompletionMessage(){return"A secret unlocked,<br>love revealed in petals."}async init(){this.createLockedBox(),this.createLetsGoButton(),this.setupInteraction(),await super.init(),this.unsubscribeUpdate=this.sceneManager.onUpdate(this.update.bind(this))}createLetsGoButton(){this.buttonElement=document.createElement("div"),this.buttonElement.id="lets-go-button",this.buttonElement.innerHTML='\n            <button class="lets-go-btn">Let\'s Go</button>\n        ',this.buttonElement.style.cssText="\n            position: fixed;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            z-index: 100;\n            opacity: 0;\n            transition: opacity 0.5s;\n        ";const e=document.createElement("style");e.textContent="\n            .lets-go-btn {\n                font-family: 'Orbitron', sans-serif;\n                font-size: 1.5rem;\n                padding: 15px 40px;\n                background: linear-gradient(135deg, #ff00ff, #00ffff);\n                border: 2px solid #ffffff;\n                border-radius: 50px;\n                color: #ffffff;\n                cursor: pointer;\n                text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);\n                box-shadow: 0 0 20px rgba(255, 0, 255, 0.6), 0 0 40px rgba(0, 255, 255, 0.4);\n                transition: all 0.3s ease;\n            }\n            .lets-go-btn:hover {\n                transform: scale(1.1);\n                box-shadow: 0 0 30px rgba(255, 0, 255, 0.8), 0 0 60px rgba(0, 255, 255, 0.6);\n            }\n            .lets-go-btn:active {\n                transform: scale(0.95);\n            }\n            \n            /* Mobile Responsive */\n            @media (max-width: 768px) {\n                .lets-go-btn {\n                    font-size: 1.2rem;\n                    padding: 12px 30px;\n                }\n            }\n            @media (max-width: 480px) {\n                .lets-go-btn {\n                    font-size: 1rem;\n                    padding: 10px 25px;\n                }\n            }\n        ",document.head.appendChild(e),document.body.appendChild(this.buttonElement),setTimeout(()=>{this.buttonElement.style.opacity="1"},500);this.buttonElement.querySelector(".lets-go-btn").addEventListener("click",()=>{this.onLetsGoClick()})}createLockedBox(){const e=new n(1.2,.8,1.2),t=new i({color:2956110,metalness:.8,roughness:.2,emissive:o.champagneGold,emissiveIntensity:.05});this.box=new s(e,t),this.box.position.set(0,-.4,0),this.box.visible=!1,this.group.add(this.box);const l=new n(1.3,.15,1.3),c=new i({color:2956110,metalness:.9,roughness:.1,emissive:o.roseRed,emissiveIntensity:.1});this.boxLid=new s(l,c),this.boxLid.position.set(0,.05,0),this.boxLid.visible=!1,this.group.add(this.boxLid);const h=new r(e),f=new a({color:o.champagneGold,linewidth:2});this.boxEdges=new d(h,f),this.boxEdges.position.copy(this.box.position),this.boxEdges.visible=!1,this.group.add(this.boxEdges),this.createLetter(),this.createRevealedRose()}createLetter(){const e=new l(.6,.4),t=new i({color:16774630,metalness:0,roughness:.8,side:c});this.letter=new s(e,t),this.letter.position.set(0,-.3,.3),this.letter.rotation.x=-Math.PI/6,this.letter.visible=!1,this.group.add(this.letter);const n=new h(.08,32),r=new i({color:o.roseRed,emissive:o.roseRed,emissiveIntensity:.3});this.seal=new s(n,r),this.seal.position.set(0,-.3,.31),this.seal.rotation.x=-Math.PI/6,this.seal.visible=!1,this.group.add(this.seal)}createRevealedRose(){this.revealedRose=new f;const e=new u;e.moveTo(0,0),e.quadraticCurveTo(.12,.15,0,.3),e.quadraticCurveTo(-.12,.15,0,0);const t=new p(e,{depth:.01,bevelEnabled:!1});for(let n=0;n<3;n++)for(let e=0;e<5;e++){const r=new i({color:o.roseRed,metalness:.1,roughness:.6,side:c,transparent:!0,opacity:.9}),a=new s(t,r),d=e/5*Math.PI*2+.3*n,l=.08+.08*n;a.position.set(Math.cos(d)*l,.05*n,Math.sin(d)*l),a.rotation.set(Math.PI/4+.15*n,d+Math.PI/2,0),a.scale.setScalar(.8+.2*n),this.revealedRose.add(a)}this.revealedRose.position.set(-.3,-.2,0),this.revealedRose.visible=!1,this.group.add(this.revealedRose)}onLetsGoClick(){b.to(this.buttonElement,{opacity:0,duration:.5,onComplete:()=>{this.buttonElement.remove()}}),setTimeout(()=>this.showQuiz(),500)}showQuiz(){this.gamePhase="quiz",this.currentQuestionIndex=0,this.quizOverlay=document.createElement("div"),this.quizOverlay.id="quiz-overlay",this.quizOverlay.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(18, 12, 24, 0.95);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            z-index: 1000;\n            opacity: 0;\n            transition: opacity 0.5s;\n        ",document.body.appendChild(this.quizOverlay),this.updateQuizDisplay(),setTimeout(()=>{this.quizOverlay.style.opacity="1"},50)}updateQuizDisplay(){const e=this.quizQuestions[this.currentQuestionIndex];this.quizOverlay.innerHTML=`\n            <div class="quiz-card">\n                <div class="quiz-header">Rose Day Quiz</div>\n                <div class="question-number">Question ${this.currentQuestionIndex+1} of ${this.quizQuestions.length}</div>\n                <div class="question-text">${e.question}</div>\n                <div class="options-container">\n                    ${e.options.map((e,t)=>`\n                        <button class="option-btn" data-index="${t}">${e}</button>\n                    `).join("")}\n                </div>\n            </div>\n        `;const t=document.createElement("style");t.textContent="\n            .quiz-card {\n                background: linear-gradient(135deg, #2d1b4e, #120c18);\n                border: 3px solid #ff00ff;\n                border-radius: 20px;\n                padding: 40px;\n                max-width: 600px;\n                width: 90%;\n                box-shadow: 0 0 40px rgba(255, 0, 255, 0.5);\n            }\n            .quiz-header {\n                font-family: 'Orbitron', sans-serif;\n                font-size: 2rem;\n                color: #00ffff;\n                text-align: center;\n                margin-bottom: 10px;\n                text-shadow: 0 0 15px #00ffff;\n            }\n            .question-number {\n                font-family: 'Orbitron', sans-serif;\n                font-size: 1rem;\n                color: #ff00ff;\n                text-align: center;\n                margin-bottom: 30px;\n            }\n            .question-text {\n                font-family: 'Patrick Hand', cursive;\n                font-size: 1.5rem;\n                color: #ffffff;\n                margin-bottom: 30px;\n                text-align: center;\n            }\n            .options-container {\n                display: flex;\n                flex-direction: column;\n                gap: 15px;\n            }\n            .option-btn {\n                font-family: 'Orbitron', sans-serif;\n                font-size: 1.1rem;\n                padding: 15px 20px;\n                background: rgba(255, 255, 255, 0.1);\n                border: 2px solid #00ffff;\n                border-radius: 10px;\n                color: #ffffff;\n                cursor: pointer;\n                transition: all 0.3s;\n            }\n            .option-btn:hover {\n                background: rgba(0, 255, 255, 0.2);\n                transform: translateX(10px);\n                box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);\n            }\n            .option-btn.correct {\n                background: rgba(0, 255, 0, 0.3);\n                border-color: #00ff00;\n            }\n            .option-btn.wrong {\n                background: rgba(255, 0, 0, 0.3);\n                border-color: #ff0000;\n            }\n            \n            /* Responsive Design */\n            @media (max-width: 768px) {\n                .quiz-card {\n                    padding: 30px 20px;\n                    width: 95%;\n                }\n                .quiz-header {\n                    font-size: 1.5rem;\n                }\n                .question-text {\n                    font-size: 1.2rem;\n                }\n                .option-btn {\n                    font-size: 1rem;\n                    padding: 12px 15px;\n                }\n            }\n            @media (max-width: 480px) {\n                .quiz-card {\n                    padding: 20px 15px;\n                }\n                .quiz-header {\n                    font-size: 1.3rem;\n                }\n                .question-text {\n                    font-size: 1.1rem;\n                }\n                .option-btn {\n                    font-size: 0.9rem;\n                    padding: 10px 12px;\n                }\n            }\n        ",document.head.appendChild(t);this.quizOverlay.querySelectorAll(".option-btn").forEach(e=>{e.addEventListener("click",e=>this.handleQuizAnswer(e))})}handleQuizAnswer(e){const t=parseInt(e.target.dataset.index),n=this.quizQuestions[this.currentQuestionIndex];if(t===n.correct)this.correctAnswers++,e.target.classList.add("correct");else{e.target.classList.add("wrong");this.quizOverlay.querySelector(`[data-index="${n.correct}"]`).classList.add("correct")}this.quizOverlay.querySelectorAll(".option-btn").forEach(e=>e.disabled=!0),setTimeout(()=>{this.currentQuestionIndex++,this.currentQuestionIndex<this.quizQuestions.length?this.updateQuizDisplay():this.finishQuiz()},1500)}finishQuiz(){this.correctAnswers>=2?b.to(this.quizOverlay,{opacity:0,duration:.5,onComplete:()=>{this.quizOverlay.remove(),this.showCelebration()}}):(this.quizOverlay.innerHTML=`\n                <div class="quiz-card">\n                    <div class="quiz-header" style="color: #ff0000;">Try Again!</div>\n                    <div class="question-text">You got ${this.correctAnswers} out of ${this.quizQuestions.length} correct.</div>\n                    <div class="question-text">You need at least 2 correct answers.</div>\n                    <button class="option-btn" id="retry-btn">Retry Quiz</button>\n                </div>\n            `,document.getElementById("retry-btn").addEventListener("click",()=>{this.currentQuestionIndex=0,this.correctAnswers=0,this.updateQuizDisplay()}))}showCelebration(){this.gamePhase="celebration",this.celebrationOverlay=document.createElement("div"),this.celebrationOverlay.id="celebration-overlay",this.celebrationOverlay.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: linear-gradient(135deg, #2d1b4e, #120c18);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            z-index: 1000;\n            opacity: 0;\n            transition: opacity 0.5s;\n        ",this.celebrationOverlay.innerHTML='\n            <div class="congrats-text">üéâ Congratulations! üéâ</div>\n            <div class="congrats-subtext">You passed the Rose Day Quiz!</div>\n            <button class="open-box-btn">Open Your Gift</button>\n        ',document.body.appendChild(this.celebrationOverlay);const e=document.createElement("style");e.textContent="\n            .congrats-text {\n                font-family: 'Orbitron', sans-serif;\n                font-size: 3rem;\n                color: #ff00ff;\n                text-shadow: 0 0 20px #ff00ff;\n                margin-bottom: 20px;\n                animation: pulse 2s infinite;\n            }\n            .congrats-subtext {\n                font-family: 'Patrick Hand', cursive;\n                font-size: 1.5rem;\n                color: #00ffff;\n                margin-bottom: 40px;\n            }\n            .open-box-btn {\n                font-family: 'Orbitron', sans-serif;\n                font-size: 1.3rem;\n                padding: 15px 40px;\n                background: linear-gradient(135deg, #ff00ff, #ff69b4);\n                border: 2px solid #ffffff;\n                border-radius: 50px;\n                color: #ffffff;\n                cursor: pointer;\n                box-shadow: 0 0 20px rgba(255, 105, 180, 0.6);\n                transition: all 0.3s;\n            }\n            .open-box-btn:hover {\n                transform: scale(1.1);\n                box-shadow: 0 0 40px rgba(255, 105, 180, 0.8);\n            }\n            @keyframes pulse {\n                0%, 100% { transform: scale(1); }\n                50% { transform: scale(1.05); }\n            }\n        ",document.head.appendChild(e),setTimeout(()=>{this.celebrationOverlay.style.opacity="1",this.createConfetti()},50),this.celebrationOverlay.querySelector(".open-box-btn").addEventListener("click",()=>{this.hideCelebration()})}createConfetti(){for(let t=0;t<100;t++)setTimeout(()=>{const e=document.createElement("div");e.className="confetti",e.style.cssText=`\n                    position: fixed;\n                    width: 10px;\n                    height: 10px;\n                    background: ${t%3==0?"#FFB6C1":t%3==1?"#FF69B4":"#FFC0CB"};\n                    left: ${100*Math.random()}%;\n                    top: -10px;\n                    opacity: ${.5+.5*Math.random()};\n                    border-radius: ${Math.random()>.5?"50%":"0"};\n                    animation: confetti-fall ${3+3*Math.random()}s linear forwards;\n                    z-index: 1001;\n                `,this.celebrationOverlay.appendChild(e),setTimeout(()=>e.remove(),6e3)},50*t);const e=document.createElement("style");e.textContent=`\n            @keyframes confetti-fall {\n                to {\n                    transform: translateY(100vh) rotate(${720*Math.random()}deg);\n                }\n            }\n        `,document.head.appendChild(e)}hideCelebration(){b.to(this.celebrationOverlay,{opacity:0,duration:.5,onComplete:()=>{this.celebrationOverlay.remove(),this.showGiftBox()}})}showGiftBox(){this.gamePhase="giftChoice",this.giftOverlay=document.createElement("div"),this.giftOverlay.id="gift-overlay",this.giftOverlay.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: linear-gradient(135deg, #2d1b4e, #120c18);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            z-index: 1000;\n            opacity: 0;\n            transition: opacity 0.5s;\n        ",this.giftOverlay.innerHTML='\n            <div class="gift-container">\n                <div class="gift-header">Choose Your Gift</div>\n                <div class="gifts-row">\n                    <div class="gift-item" data-gift="rose">\n                        <div class="gift-icon">üåπ</div>\n                        <div class="gift-label">Rose</div>\n                        <button class="pick-btn" data-gift="rose">Pick Rose</button>\n                    </div>\n                    <div class="gift-item" data-gift="letter">\n                        <div class="gift-icon">üíå</div>\n                        <div class="gift-label">Letter</div>\n                        <button class="pick-btn" data-gift="letter">Pick Letter</button>\n                    </div>\n                </div>\n            </div>\n        ',document.body.appendChild(this.giftOverlay);const e=document.createElement("style");e.textContent="\n            .gift-container {\n                text-align: center;\n                padding: 40px;\n            }\n            .gift-header {\n                font-family: 'Orbitron', sans-serif;\n                font-size: 2.5rem;\n                color: #ff00ff;\n                text-shadow: 0 0 20px #ff00ff;\n                margin-bottom: 50px;\n            }\n            .gifts-row {\n                display: flex;\n                gap: 60px;\n                justify-content: center;\n            }\n            .gift-item {\n                background: rgba(255, 255, 255, 0.05);\n                border: 3px solid #00ffff;\n                border-radius: 20px;\n                padding: 40px;\n                min-width: 200px;\n                transition: all 0.3s;\n            }\n            .gift-item:hover {\n                transform: translateY(-10px);\n                box-shadow: 0 10px 40px rgba(0, 255, 255, 0.5);\n            }\n            .gift-icon {\n                font-size: 5rem;\n                margin-bottom: 20px;\n            }\n            .gift-label {\n                font-family: 'Patrick Hand', cursive;\n                font-size: 1.8rem;\n                color: #ffffff;\n                margin-bottom: 20px;\n            }\n            .pick-btn {\n                font-family: 'Orbitron', sans-serif;\n                font-size: 1.1rem;\n                padding: 12px 30px;\n                background: linear-gradient(135deg, #ff00ff, #00ffff);\n                border: 2px solid #ffffff;\n                border-radius: 30px;\n                color: #ffffff;\n                cursor: pointer;\n                transition: all 0.3s;\n            }\n            .pick-btn:hover {\n                transform: scale(1.1);\n                box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);\n            }\n        ",document.head.appendChild(e),setTimeout(()=>{this.giftOverlay.style.opacity="1"},50),this.giftOverlay.querySelectorAll(".pick-btn").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.dataset.gift;this.handleGiftSelection(t)})})}handleGiftSelection(e){b.to(this.giftOverlay,{opacity:0,duration:.5,onComplete:()=>{this.giftOverlay.remove(),"rose"===e?this.showRoseWish():this.showLetter()}})}showRoseWish(){this.gamePhase="ending";const e=document.createElement("div");e.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: linear-gradient(135deg, #ff69b4, #ff1493, #8b008b);\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            z-index: 1000;\n            opacity: 0;\n            transition: opacity 0.5s;\n        ",e.innerHTML='\n            <div style="font-size: 6rem; margin-bottom: 30px;">üåπ</div>\n            <div style="font-family: \'Orbitron\', sans-serif; font-size: 3.5rem; color: #ffffff; text-shadow: 0 0 30px rgba(255,255,255,0.8); margin-bottom: 20px;">\n                Happy Rose Day!\n            </div>\n            <div style="font-family: \'Patrick Hand\', cursive; font-size: 1.8rem; color: #ffe4e1; text-align: center; max-width: 600px;">\n                May your  life be as beautiful and fragrant as a rose! üåπ‚ú®\n            </div>\n            <button class="finish-btn" style="margin-top: 40px; font-family: \'Orbitron\', sans-serif; font-size: 1.2rem; padding: 15px 40px; background: rgba(255,255,255,0.2); border: 2px solid #ffffff; border-radius: 50px; color: #ffffff; cursor: pointer;">\n                Complete Experience\n            </button>\n        ',document.body.appendChild(e),setTimeout(()=>{e.style.opacity="1"},50),e.querySelector(".finish-btn").addEventListener("click",async()=>{b.to(e,{opacity:0,duration:.5,onComplete:()=>{e.remove(),this.complete()}})})}showLetter(){this.gamePhase="ending";const e=document.createElement("div");e.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: linear-gradient(135deg, #8b4513, #d4af37, #8b4513);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            z-index: 1000;\n            opacity: 0;\n            transition: opacity 0.5s;\n        ",e.innerHTML='\n            <div style="background: #faf0e6; border: 8px solid #d4af37; border-radius: 15px; padding: 60px; max-width: 500px; box-shadow: 0 0 50px rgba(212, 175, 55, 0.7); text-align: center;">\n                <div style="font-family: \'Brush Script MT\', cursive; font-size: 2.5rem; color: #8b4513; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(139, 69, 19, 0.3);">\n                    üîê Locked Letter\n                </div>\n                <div style="font-family: \'Georgia\', serif; font-size: 1.2rem; color: #4a0e0e; margin-bottom: 30px;">\n                    Enter the password to unlock your special letter\n                </div>\n                <input \n                    type="password" \n                    id="letter-password" \n                    placeholder="Enter password" \n                    style="font-family: \'Georgia\', serif; font-size: 1.1rem; padding: 12px 20px; width: 80%; border: 2px solid #d4af37; border-radius: 10px; margin-bottom: 10px; text-align: center;"\n                />\n                <div id="password-error" style="font-family: \'Georgia\', serif; font-size: 0.9rem; color: #ff0000; height: 20px; margin-bottom: 10px;"></div>\n                <button id="unlock-btn" style="font-family: \'Georgia\', serif; font-size: 1.1rem; padding: 12px 40px; background: linear-gradient(135deg, #d4af37, #ffd700); border: 2px solid #8b4513; border-radius: 30px; color: #4a0e0e; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(139, 69, 19, 0.4); margin-top: 10px;">\n                    Unlock\n                </button>\n            </div>\n        ',document.body.appendChild(e),setTimeout(()=>{e.style.opacity="1",document.getElementById("letter-password").focus()},50);const t=document.getElementById("unlock-btn"),n=document.getElementById("letter-password"),i=document.getElementById("password-error"),o=()=>{"ilykiddo"===n.value.trim()?b.to(e,{opacity:0,duration:.5,onComplete:()=>{e.remove(),this.displayLetter()}}):(i.textContent="‚ùå Incorrect password. Try again!",n.value="",n.focus(),n.style.animation="shake 0.5s",setTimeout(()=>{n.style.animation=""},500))};t.addEventListener("click",o),n.addEventListener("keypress",e=>{"Enter"===e.key&&o()});const s=document.createElement("style");s.textContent="\n            @keyframes shake {\n                0%, 100% { transform: translateX(0); }\n                25% { transform: translateX(-10px); }\n                75% { transform: translateX(10px); }\n            }\n        ",document.head.appendChild(s)}displayLetter(){const e=["Life is the flower for which love is the honey. ‚Äî Victor Hugo","Love is not just looking at each other, it's looking in the same direction. ‚Äî Antoine de Saint-Exup√©ry","The best thing to hold onto in life is each other. ‚Äî Audrey Hepburn","Life without love is like a tree without blossoms or fruit. ‚Äî Khalil Gibran"],t=e[Math.floor(Math.random()*e.length)],n=document.createElement("div");n.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: linear-gradient(135deg, #8b4513, #d4af37, #8b4513);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            z-index: 1000;\n            opacity: 0;\n            transition: opacity 0.5s;\n        ",n.innerHTML=`\n            <div style="background: #faf0e6; border: 8px solid #d4af37; border-radius: 15px; padding: 60px; max-width: 700px; box-shadow: 0 0 50px rgba(212, 175, 55, 0.7);">\n                <div style="text-align: center; margin-bottom: 30px;">\n                    <div style="font-family: 'Brush Script MT', cursive; font-size: 3rem; color: #8b4513; text-shadow: 2px 2px 4px rgba(139, 69, 19, 0.3);">\n                        Royal Letter\n                    </div>\n                    <div style="font-size: 2rem; color: #d4af37;">üíå</div>\n                </div>\n                <div style="font-family: 'Georgia', serif; font-size: 1.6rem; color: #4a0e0e; line-height: 2; font-style: italic; text-align: center; border-top: 2px solid #d4af37; border-bottom: 2px solid #d4af37; padding: 30px 0;">\n                    "${t.split(" ‚Äî ")[0]}"\n                </div>\n                <div style="font-family: 'Georgia', serif; font-size: 1.2rem; color: #8b4513; text-align: right; margin-top: 20px; font-weight: bold;">\n                    ‚Äî ${t.split(" ‚Äî ")[1]}\n                </div>\n                <button class="finish-btn" style="display: block; margin: 40px auto 0; font-family: 'Georgia', serif; font-size: 1.2rem; padding: 15px 40px; background: linear-gradient(135deg, #d4af37, #ffd700); border: 2px solid #8b4513; border-radius: 30px; color: #4a0e0e; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(139, 69, 19, 0.4);">\n                    Complete Experience\n                </button>\n            </div>\n        `,document.body.appendChild(n),setTimeout(()=>{n.style.opacity="1"},50),n.querySelector(".finish-btn").addEventListener("click",async()=>{b.to(n,{opacity:0,duration:.5,onComplete:()=>{n.remove(),this.complete()}})})}setupInteraction(){this.boundClick=this.onClick.bind(this),this.boundMouseMove=this.onMouseMove.bind(this),window.addEventListener("click",this.boundClick),window.addEventListener("touchend",this.boundClick),window.addEventListener("mousemove",this.boundMouseMove),window.addEventListener("touchmove",this.boundMouseMove,{passive:!1})}onMouseMove(e){var t,n,i,o;"touchmove"===e.type&&e.preventDefault();const s=e.clientX||(null==(n=null==(t=e.touches)?void 0:t[0])?void 0:n.clientX),r=e.clientY||(null==(o=null==(i=e.touches)?void 0:i[0])?void 0:o.clientY);if(void 0===s)return;this.mouse.x=s/window.innerWidth*2-1,this.mouse.y=-r/window.innerHeight*2+1,this.raycaster.setFromCamera(this.mouse,this.sceneManager.camera);let a=[];"collecting"===this.gamePhase?a=this.petals.filter(e=>!e.userData.isCollected):"boxReveal"===this.gamePhase?a=[this.box,this.boxLid]:"letterReveal"===this.gamePhase&&(a=[this.letter,this.seal]);const d=this.raycaster.intersectObjects(a),l=document.getElementById("cursor");d.length>0?l&&l.classList.add("hover"):l&&l.classList.remove("hover")}onClick(e){"interactive"===this.phase&&(this.raycaster.setFromCamera(this.mouse,this.sceneManager.camera),"boxReveal"===this.gamePhase?this.handleBoxClick():"letterReveal"===this.gamePhase&&this.handleLetterClick())}revealBox(){this.gamePhase="boxReveal",this.box.visible=!0,this.boxLid.visible=!0,this.boxEdges.visible=!0,this.box.scale.set(0,0,0),this.boxLid.scale.set(0,0,0),this.boxEdges.scale.set(0,0,0),b.to(this.box.scale,{x:1,y:1,z:1,duration:1,ease:"elastic.out(1, 0.5)"}),b.to(this.boxLid.scale,{x:1,y:1,z:1,duration:1,delay:.1,ease:"elastic.out(1, 0.5)"}),b.to(this.boxEdges.scale,{x:1,y:1,z:1,duration:1,delay:.2,ease:"elastic.out(1, 0.5)"}),this.updateInstruction("Click the box to open...")}handleBoxClick(){this.raycaster.intersectObjects([this.box,this.boxLid,this.boxEdges]).length>0&&this.openBox()}openBox(){this.gamePhase="letterReveal",b.to(this.boxLid.rotation,{x:.8*-Math.PI,duration:1,ease:"power2.out"}),b.to(this.boxLid.position,{y:.4,z:-.5,duration:1,ease:"power2.out"}),setTimeout(()=>{this.letter.visible=!0,this.seal.visible=!0,this.revealedRose.visible=!0,b.from(this.letter.position,{y:-.8,duration:.8,ease:"power2.out"}),b.from(this.seal.position,{y:-.8,duration:.8,ease:"power2.out"}),b.from(this.revealedRose.position,{y:-.8,duration:1,ease:"power2.out"}),b.to(this.revealedRose.rotation,{y:2*Math.PI,duration:3,ease:"power1.inOut"})},600),this.updateInstruction("Click the letter to read...")}handleLetterClick(){this.raycaster.intersectObjects([this.letter,this.seal]).length>0&&this.showQuote()}showQuote(){this.gamePhase="quoteDisplay",this.quoteOverlay=document.createElement("div"),this.quoteOverlay.id="quote-overlay",this.quoteOverlay.innerHTML=`\n            <div class="quote-card">\n                <div class="quote-text">"${this.romanticQuote}"</div>\n                <div class="quote-author">${this.quoteAuthor}</div>\n                <button class="close-btn">‚úï</button>\n            </div>\n        `,this.quoteOverlay.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(18, 12, 24, 0.9);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            z-index: 1000;\n            opacity: 0;\n            transition: opacity 0.5s;\n        ",document.body.appendChild(this.quoteOverlay);this.quoteOverlay.querySelector(".quote-card").style.cssText="\n            background: linear-gradient(135deg, #2d1b4e, #120c18);\n            border: 2px solid #ff00ff;\n            border-radius: 20px;\n            padding: 40px 50px;\n            max-width: 500px;\n            text-align: center;\n            box-shadow: 0 0 40px rgba(255, 0, 255, 0.3);\n            position: relative;\n        ";this.quoteOverlay.querySelector(".quote-text").style.cssText="\n            font-family: 'Patrick Hand', cursive;\n            font-size: 1.8rem;\n            color: #ffffff;\n            line-height: 1.6;\n            margin-bottom: 20px;\n        ";this.quoteOverlay.querySelector(".quote-author").style.cssText="\n            font-family: 'Orbitron', sans-serif;\n            font-size: 1rem;\n            color: #00ffff;\n            text-shadow: 0 0 10px #00ffff;\n        ";const e=this.quoteOverlay.querySelector(".close-btn");e.style.cssText="\n            position: absolute;\n            top: 15px;\n            right: 20px;\n            background: none;\n            border: none;\n            color: #ff00ff;\n            font-size: 1.5rem;\n            cursor: pointer;\n        ",e.addEventListener("click",()=>{this.closeQuoteAndComplete()}),setTimeout(()=>{this.quoteOverlay.style.opacity="1"},50)}async closeQuoteAndComplete(){b.to(this.quoteOverlay,{opacity:0,duration:.5,onComplete:()=>{this.quoteOverlay.remove()}}),this.phase="outro",await this.complete()}updateInstruction(e){const t=document.querySelector(".experience-instruction");t&&b.to(t,{opacity:0,duration:.3,onComplete:()=>{t.textContent=e,b.to(t,{opacity:1,duration:.3})}})}update(e,t){if(this.isActive){if(this.revealedRose&&this.revealedRose.visible&&(this.revealedRose.rotation.y+=.3*e),this.box&&this.box.visible&&"boxReveal"===this.gamePhase){const e=.05*Math.sin(3*t)+.1;this.box.material.emissiveIntensity=e}this.group.rotation.y+=.03*e}}dispose(){this.unsubscribeUpdate&&this.unsubscribeUpdate(),window.removeEventListener("click",this.boundClick),window.removeEventListener("touchend",this.boundClick),window.removeEventListener("mousemove",this.boundMouseMove),window.removeEventListener("touchmove",this.boundMouseMove),this.buttonElement&&this.buttonElement.parentNode&&this.buttonElement.remove(),this.quoteOverlay&&this.quoteOverlay.parentNode&&this.quoteOverlay.remove(),super.dispose()}}export{x as default};
