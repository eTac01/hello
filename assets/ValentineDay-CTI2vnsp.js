import{h as t,C as e,g as i,a as s,I as n,f as o,G as a,A as r,r as u}from"./index-DI5LSjs4.js";import{B as h}from"./BaseExperience-CpvtY6rA.js";class p extends h{constructor(t,e,i){super(t,e,i),this.entity1=null,this.entity2=null,this.mergeProgress=0}getInstruction(){return"Witness the union..."}getCompletionMessage(){return"Two souls,<br>one light,<br>eternal."}async init(){this.createEntities(),await super.init(),this.startAutonomousMotion(),this.unsubscribeUpdate=this.sceneManager.onUpdate(this.update.bind(this))}createEntities(){const i=(e,i)=>{const h=new a,p=new s(new n(.4,2),new o({color:e,transparent:!0,opacity:.9}));h.add(p);const l=new s(new n(.7,2),new o({color:e,transparent:!0,opacity:.3,side:u,blending:r}));return h.add(l),h.position.copy(i),h.userData={core:p,glow:l,velocity:new t},h};this.entity1=i(e.champagneGold,new t(-3,1,0)),this.entity2=i(e.roseRed,new t(3,-1,0)),this.group.add(this.entity1,this.entity2)}startAutonomousMotion(){const t=i.timeline();t.to(this.entity1.position,{x:-1,y:.5,duration:8,ease:"sine.inOut"},0),t.to(this.entity2.position,{x:1,y:-.5,duration:8,ease:"sine.inOut"},0),t.to(this.entity1.position,{x:.3,y:0,duration:6,ease:"power2.in"},8),t.to(this.entity2.position,{x:-.3,y:0,duration:6,ease:"power2.in",onComplete:()=>this.onMerge()},8)}onMerge(){if(this.isCompleted)return;const t=new s(new n(.5,3),new o({color:16777215,transparent:!0}));t.position.set(0,0,0),this.group.add(t),i.to([this.entity1,this.entity2],{visible:!1,duration:.5}),i.to(t.scale,{x:15,y:15,z:15,duration:3,ease:"power2.out"}),i.to(t.material,{opacity:0,duration:3,delay:.5,onComplete:()=>this.complete()})}update(t,e){var i,s;if(!this.isActive)return;this.entity1&&(this.entity1.rotation.y+=.5*t),this.entity2&&(this.entity2.rotation.y-=.5*t);const n=.1*Math.sin(2*e)+1;(null==(i=this.entity1)?void 0:i.userData.glow)&&this.entity1.userData.glow.scale.setScalar(n),(null==(s=this.entity2)?void 0:s.userData.glow)&&this.entity2.userData.glow.scale.setScalar(n)}dispose(){this.unsubscribeUpdate&&this.unsubscribeUpdate(),super.dispose()}}export{p as default};
